{"ast":null,"code":"exports.tokenize = tokenizeHtml;\n\nvar markdownLineEnding = require('../character/markdown-line-ending');\n\nvar markdownLineEndingOrSpace = require('../character/markdown-line-ending-or-space');\n\nvar markdownSpace = require('../character/markdown-space');\n\nvar asciiAlpha = require('../character/ascii-alpha');\n\nvar asciiAlphanumeric = require('../character/ascii-alphanumeric');\n\nvar createSpace = require('./factory-space');\n\nfunction tokenizeHtml(effects, ok, nok) {\n  var marker;\n  var buffer;\n  var index;\n  var returnState;\n  return start;\n\n  function start(code) {\n    effects.enter('htmlText');\n    effects.enter('htmlTextData');\n    effects.consume(code);\n    return open;\n  }\n\n  function open(code) {\n    if (code === 33) {\n      effects.consume(code);\n      return declarationOpen;\n    }\n\n    if (code === 47) {\n      effects.consume(code);\n      return tagCloseStart;\n    }\n\n    if (code === 63) {\n      effects.consume(code);\n      return instruction;\n    }\n\n    if (asciiAlpha(code)) {\n      effects.consume(code);\n      return tagOpen;\n    }\n\n    return nok(code);\n  }\n\n  function declarationOpen(code) {\n    if (code === 45) {\n      effects.consume(code);\n      return commentOpen;\n    }\n\n    if (code === 91) {\n      effects.consume(code);\n      buffer = 'CDATA[';\n      index = 0;\n      return cdataOpen;\n    }\n\n    if (asciiAlpha(code)) {\n      effects.consume(code);\n      return declaration;\n    }\n\n    return nok(code);\n  }\n\n  function commentOpen(code) {\n    if (code === 45) {\n      effects.consume(code);\n      return commentStart;\n    }\n\n    return nok(code);\n  }\n\n  function commentStart(code) {\n    if (code === null || code === 62) {\n      return nok(code);\n    }\n\n    if (code === 45) {\n      effects.consume(code);\n      return commentStartDash;\n    }\n\n    return comment(code);\n  }\n\n  function commentStartDash(code) {\n    if (code === null || code === 62) {\n      return nok(code);\n    }\n\n    return comment(code);\n  }\n\n  function comment(code) {\n    if (code === null) {\n      return nok(code);\n    }\n\n    if (code === 45) {\n      effects.consume(code);\n      return commentClose;\n    }\n\n    if (markdownLineEnding(code)) {\n      returnState = comment;\n      return atLineEnding(code);\n    }\n\n    effects.consume(code);\n    return comment;\n  }\n\n  function commentClose(code) {\n    if (code === 45) {\n      effects.consume(code);\n      return end;\n    }\n\n    return comment(code);\n  }\n\n  function cdataOpen(code) {\n    if (code === buffer.charCodeAt(index++)) {\n      effects.consume(code);\n      return index === buffer.length ? cdata : cdataOpen;\n    }\n\n    return nok(code);\n  }\n\n  function cdata(code) {\n    if (code === null) {\n      return nok(code);\n    }\n\n    if (code === 93) {\n      effects.consume(code);\n      return cdataClose;\n    }\n\n    effects.consume(code);\n    return cdata;\n  }\n\n  function cdataClose(code) {\n    if (code === 93) {\n      effects.consume(code);\n      return cdataEnd;\n    }\n\n    return cdata(code);\n  }\n\n  function cdataEnd(code) {\n    if (code === 62) {\n      return end(code);\n    }\n\n    if (code === 93) {\n      effects.consume(code);\n      return cdataEnd;\n    }\n\n    return cdata(code);\n  }\n\n  function declaration(code) {\n    if (code === null || code === 62) {\n      return end(code);\n    }\n\n    if (markdownLineEnding(code)) {\n      returnState = declaration;\n      return atLineEnding(code);\n    }\n\n    effects.consume(code);\n    return declaration;\n  }\n\n  function instruction(code) {\n    if (code === null) {\n      return nok(code);\n    }\n\n    if (code === 63) {\n      effects.consume(code);\n      return instructionClose;\n    }\n\n    if (markdownLineEnding(code)) {\n      returnState = instruction;\n      return atLineEnding(code);\n    }\n\n    effects.consume(code);\n    return instruction;\n  }\n\n  function instructionClose(code) {\n    return code === 62 ? end(code) : instruction(code);\n  }\n\n  function tagCloseStart(code) {\n    if (asciiAlpha(code)) {\n      effects.consume(code);\n      return tagClose;\n    }\n\n    return nok(code);\n  }\n\n  function tagClose(code) {\n    if (code === 45 || asciiAlphanumeric(code)) {\n      effects.consume(code);\n      return tagClose;\n    }\n\n    return tagCloseBetween(code);\n  }\n\n  function tagCloseBetween(code) {\n    if (markdownLineEnding(code)) {\n      returnState = tagCloseBetween;\n      return atLineEnding(code);\n    }\n\n    if (markdownSpace(code)) {\n      effects.consume(code);\n      return tagCloseBetween;\n    }\n\n    return end(code);\n  }\n\n  function tagOpen(code) {\n    if (code === 45 || asciiAlphanumeric(code)) {\n      effects.consume(code);\n      return tagOpen;\n    }\n\n    if (code === 47 || code === 62 || markdownLineEndingOrSpace(code)) {\n      return tagOpenBetween(code);\n    }\n\n    return nok(code);\n  }\n\n  function tagOpenBetween(code) {\n    if (code === 47) {\n      effects.consume(code);\n      return end;\n    }\n\n    if (code === 58 || code === 95 || asciiAlpha(code)) {\n      effects.consume(code);\n      return tagOpenAttributeName;\n    }\n\n    if (markdownLineEnding(code)) {\n      returnState = tagOpenBetween;\n      return atLineEnding(code);\n    }\n\n    if (markdownSpace(code)) {\n      effects.consume(code);\n      return tagOpenBetween;\n    }\n\n    return end(code);\n  }\n\n  function tagOpenAttributeName(code) {\n    if (code === 45 || code === 46 || code === 58 || code === 95 || asciiAlphanumeric(code)) {\n      effects.consume(code);\n      return tagOpenAttributeName;\n    }\n\n    return tagOpenAttributeNameAfter(code);\n  }\n\n  function tagOpenAttributeNameAfter(code) {\n    if (code === 61) {\n      effects.consume(code);\n      return tagOpenAttributeValueBefore;\n    }\n\n    if (markdownLineEnding(code)) {\n      returnState = tagOpenAttributeNameAfter;\n      return atLineEnding(code);\n    }\n\n    if (markdownSpace(code)) {\n      effects.consume(code);\n      return tagOpenAttributeNameAfter;\n    }\n\n    return tagOpenBetween(code);\n  }\n\n  function tagOpenAttributeValueBefore(code) {\n    if (code === null || code === 60 || code === 61 || code === 62 || code === 96) {\n      return nok(code);\n    }\n\n    if (code === 34 || code === 39) {\n      effects.consume(code);\n      marker = code;\n      return tagOpenAttributeValueQuoted;\n    }\n\n    if (markdownLineEnding(code)) {\n      returnState = tagOpenAttributeValueBefore;\n      return atLineEnding(code);\n    }\n\n    if (markdownSpace(code)) {\n      effects.consume(code);\n      return tagOpenAttributeValueBefore;\n    }\n\n    effects.consume(code);\n    marker = undefined;\n    return tagOpenAttributeValueUnquoted;\n  }\n\n  function tagOpenAttributeValueQuoted(code) {\n    if (code === marker) {\n      effects.consume(code);\n      return tagOpenAttributeValueQuotedAfter;\n    }\n\n    if (code === null) {\n      return nok(code);\n    }\n\n    if (markdownLineEnding(code)) {\n      returnState = tagOpenAttributeValueQuoted;\n      return atLineEnding(code);\n    }\n\n    effects.consume(code);\n    return tagOpenAttributeValueQuoted;\n  }\n\n  function tagOpenAttributeValueQuotedAfter(code) {\n    if (code === 62 || code === 47 || markdownLineEndingOrSpace(code)) {\n      return tagOpenBetween(code);\n    }\n\n    return nok(code);\n  }\n\n  function tagOpenAttributeValueUnquoted(code) {\n    if (code === null || code === 34 || code === 39 || code === 60 || code === 61 || code === 96) {\n      return nok(code);\n    }\n\n    if (code === 62 || markdownLineEndingOrSpace(code)) {\n      return tagOpenBetween(code);\n    }\n\n    effects.consume(code);\n    return tagOpenAttributeValueUnquoted;\n  } // We can’t have blank lines in content, so no need to worry about empty\n  // tokens.\n\n\n  function atLineEnding(code) {\n    effects.exit('htmlTextData');\n    effects.enter('lineEnding');\n    effects.consume(code);\n    effects.exit('lineEnding');\n    return createSpace(effects, afterPrefix, 'linePrefix', 4);\n  }\n\n  function afterPrefix(code) {\n    effects.enter('htmlTextData');\n    return returnState(code);\n  }\n\n  function end(code) {\n    if (code === 62) {\n      effects.consume(code);\n      effects.exit('htmlTextData');\n      effects.exit('htmlText');\n      return ok;\n    }\n\n    return nok(code);\n  }\n}","map":{"version":3,"sources":["/home/boshra/personal/markdown-editor/node_modules/micromark/dist/tokenize/html-text.js"],"names":["exports","tokenize","tokenizeHtml","markdownLineEnding","require","markdownLineEndingOrSpace","markdownSpace","asciiAlpha","asciiAlphanumeric","createSpace","effects","ok","nok","marker","buffer","index","returnState","start","code","enter","consume","open","declarationOpen","tagCloseStart","instruction","tagOpen","commentOpen","cdataOpen","declaration","commentStart","commentStartDash","comment","commentClose","atLineEnding","end","charCodeAt","length","cdata","cdataClose","cdataEnd","instructionClose","tagClose","tagCloseBetween","tagOpenBetween","tagOpenAttributeName","tagOpenAttributeNameAfter","tagOpenAttributeValueBefore","tagOpenAttributeValueQuoted","undefined","tagOpenAttributeValueUnquoted","tagOpenAttributeValueQuotedAfter","exit","afterPrefix"],"mappings":"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","sourcesContent":["exports.tokenize = tokenizeHtml\n\nvar markdownLineEnding = require('../character/markdown-line-ending')\nvar markdownLineEndingOrSpace = require('../character/markdown-line-ending-or-space')\nvar markdownSpace = require('../character/markdown-space')\nvar asciiAlpha = require('../character/ascii-alpha')\nvar asciiAlphanumeric = require('../character/ascii-alphanumeric')\n\nvar createSpace = require('./factory-space')\n\nfunction tokenizeHtml(effects, ok, nok) {\n  var marker\n  var buffer\n  var index\n  var returnState\n\n  return start\n\n  function start(code) {\n    effects.enter('htmlText')\n    effects.enter('htmlTextData')\n    effects.consume(code)\n    return open\n  }\n\n  function open(code) {\n    if (code === 33) {\n      effects.consume(code)\n      return declarationOpen\n    }\n\n    if (code === 47) {\n      effects.consume(code)\n      return tagCloseStart\n    }\n\n    if (code === 63) {\n      effects.consume(code)\n      return instruction\n    }\n\n    if (asciiAlpha(code)) {\n      effects.consume(code)\n      return tagOpen\n    }\n\n    return nok(code)\n  }\n\n  function declarationOpen(code) {\n    if (code === 45) {\n      effects.consume(code)\n      return commentOpen\n    }\n\n    if (code === 91) {\n      effects.consume(code)\n      buffer = 'CDATA['\n      index = 0\n      return cdataOpen\n    }\n\n    if (asciiAlpha(code)) {\n      effects.consume(code)\n      return declaration\n    }\n\n    return nok(code)\n  }\n\n  function commentOpen(code) {\n    if (code === 45) {\n      effects.consume(code)\n      return commentStart\n    }\n\n    return nok(code)\n  }\n\n  function commentStart(code) {\n    if (code === null || code === 62) {\n      return nok(code)\n    }\n\n    if (code === 45) {\n      effects.consume(code)\n      return commentStartDash\n    }\n\n    return comment(code)\n  }\n\n  function commentStartDash(code) {\n    if (code === null || code === 62) {\n      return nok(code)\n    }\n\n    return comment(code)\n  }\n\n  function comment(code) {\n    if (code === null) {\n      return nok(code)\n    }\n\n    if (code === 45) {\n      effects.consume(code)\n      return commentClose\n    }\n\n    if (markdownLineEnding(code)) {\n      returnState = comment\n      return atLineEnding(code)\n    }\n\n    effects.consume(code)\n    return comment\n  }\n\n  function commentClose(code) {\n    if (code === 45) {\n      effects.consume(code)\n      return end\n    }\n\n    return comment(code)\n  }\n\n  function cdataOpen(code) {\n    if (code === buffer.charCodeAt(index++)) {\n      effects.consume(code)\n      return index === buffer.length ? cdata : cdataOpen\n    }\n\n    return nok(code)\n  }\n\n  function cdata(code) {\n    if (code === null) {\n      return nok(code)\n    }\n\n    if (code === 93) {\n      effects.consume(code)\n      return cdataClose\n    }\n\n    effects.consume(code)\n    return cdata\n  }\n\n  function cdataClose(code) {\n    if (code === 93) {\n      effects.consume(code)\n      return cdataEnd\n    }\n\n    return cdata(code)\n  }\n\n  function cdataEnd(code) {\n    if (code === 62) {\n      return end(code)\n    }\n\n    if (code === 93) {\n      effects.consume(code)\n      return cdataEnd\n    }\n\n    return cdata(code)\n  }\n\n  function declaration(code) {\n    if (code === null || code === 62) {\n      return end(code)\n    }\n\n    if (markdownLineEnding(code)) {\n      returnState = declaration\n      return atLineEnding(code)\n    }\n\n    effects.consume(code)\n    return declaration\n  }\n\n  function instruction(code) {\n    if (code === null) {\n      return nok(code)\n    }\n\n    if (code === 63) {\n      effects.consume(code)\n      return instructionClose\n    }\n\n    if (markdownLineEnding(code)) {\n      returnState = instruction\n      return atLineEnding(code)\n    }\n\n    effects.consume(code)\n    return instruction\n  }\n\n  function instructionClose(code) {\n    return code === 62 ? end(code) : instruction(code)\n  }\n\n  function tagCloseStart(code) {\n    if (asciiAlpha(code)) {\n      effects.consume(code)\n      return tagClose\n    }\n\n    return nok(code)\n  }\n\n  function tagClose(code) {\n    if (code === 45 || asciiAlphanumeric(code)) {\n      effects.consume(code)\n      return tagClose\n    }\n\n    return tagCloseBetween(code)\n  }\n\n  function tagCloseBetween(code) {\n    if (markdownLineEnding(code)) {\n      returnState = tagCloseBetween\n      return atLineEnding(code)\n    }\n\n    if (markdownSpace(code)) {\n      effects.consume(code)\n      return tagCloseBetween\n    }\n\n    return end(code)\n  }\n\n  function tagOpen(code) {\n    if (code === 45 || asciiAlphanumeric(code)) {\n      effects.consume(code)\n      return tagOpen\n    }\n\n    if (code === 47 || code === 62 || markdownLineEndingOrSpace(code)) {\n      return tagOpenBetween(code)\n    }\n\n    return nok(code)\n  }\n\n  function tagOpenBetween(code) {\n    if (code === 47) {\n      effects.consume(code)\n      return end\n    }\n\n    if (code === 58 || code === 95 || asciiAlpha(code)) {\n      effects.consume(code)\n      return tagOpenAttributeName\n    }\n\n    if (markdownLineEnding(code)) {\n      returnState = tagOpenBetween\n      return atLineEnding(code)\n    }\n\n    if (markdownSpace(code)) {\n      effects.consume(code)\n      return tagOpenBetween\n    }\n\n    return end(code)\n  }\n\n  function tagOpenAttributeName(code) {\n    if (\n      code === 45 ||\n      code === 46 ||\n      code === 58 ||\n      code === 95 ||\n      asciiAlphanumeric(code)\n    ) {\n      effects.consume(code)\n      return tagOpenAttributeName\n    }\n\n    return tagOpenAttributeNameAfter(code)\n  }\n\n  function tagOpenAttributeNameAfter(code) {\n    if (code === 61) {\n      effects.consume(code)\n      return tagOpenAttributeValueBefore\n    }\n\n    if (markdownLineEnding(code)) {\n      returnState = tagOpenAttributeNameAfter\n      return atLineEnding(code)\n    }\n\n    if (markdownSpace(code)) {\n      effects.consume(code)\n      return tagOpenAttributeNameAfter\n    }\n\n    return tagOpenBetween(code)\n  }\n\n  function tagOpenAttributeValueBefore(code) {\n    if (\n      code === null ||\n      code === 60 ||\n      code === 61 ||\n      code === 62 ||\n      code === 96\n    ) {\n      return nok(code)\n    }\n\n    if (code === 34 || code === 39) {\n      effects.consume(code)\n      marker = code\n      return tagOpenAttributeValueQuoted\n    }\n\n    if (markdownLineEnding(code)) {\n      returnState = tagOpenAttributeValueBefore\n      return atLineEnding(code)\n    }\n\n    if (markdownSpace(code)) {\n      effects.consume(code)\n      return tagOpenAttributeValueBefore\n    }\n\n    effects.consume(code)\n    marker = undefined\n    return tagOpenAttributeValueUnquoted\n  }\n\n  function tagOpenAttributeValueQuoted(code) {\n    if (code === marker) {\n      effects.consume(code)\n      return tagOpenAttributeValueQuotedAfter\n    }\n\n    if (code === null) {\n      return nok(code)\n    }\n\n    if (markdownLineEnding(code)) {\n      returnState = tagOpenAttributeValueQuoted\n      return atLineEnding(code)\n    }\n\n    effects.consume(code)\n    return tagOpenAttributeValueQuoted\n  }\n\n  function tagOpenAttributeValueQuotedAfter(code) {\n    if (code === 62 || code === 47 || markdownLineEndingOrSpace(code)) {\n      return tagOpenBetween(code)\n    }\n\n    return nok(code)\n  }\n\n  function tagOpenAttributeValueUnquoted(code) {\n    if (\n      code === null ||\n      code === 34 ||\n      code === 39 ||\n      code === 60 ||\n      code === 61 ||\n      code === 96\n    ) {\n      return nok(code)\n    }\n\n    if (code === 62 || markdownLineEndingOrSpace(code)) {\n      return tagOpenBetween(code)\n    }\n\n    effects.consume(code)\n    return tagOpenAttributeValueUnquoted\n  }\n\n  // We can’t have blank lines in content, so no need to worry about empty\n  // tokens.\n  function atLineEnding(code) {\n    effects.exit('htmlTextData')\n    effects.enter('lineEnding')\n    effects.consume(code)\n    effects.exit('lineEnding')\n    return createSpace(effects, afterPrefix, 'linePrefix', 4)\n  }\n\n  function afterPrefix(code) {\n    effects.enter('htmlTextData')\n    return returnState(code)\n  }\n\n  function end(code) {\n    if (code === 62) {\n      effects.consume(code)\n      effects.exit('htmlTextData')\n      effects.exit('htmlText')\n      return ok\n    }\n\n    return nok(code)\n  }\n}\n"]},"metadata":{},"sourceType":"script"}